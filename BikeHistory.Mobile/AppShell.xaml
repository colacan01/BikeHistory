<?xml version="1.0" encoding="UTF-8" ?>
<Shell
    x:Class="BikeHistory.Mobile.AppShell"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:local="clr-namespace:BikeHistory.Mobile"
    xmlns:auth="clr-namespace:BikeHistory.Mobile.Views.Auth"
    xmlns:bikes="clr-namespace:BikeHistory.Mobile.Views.Bikes"
    xmlns:maintenance="clr-namespace:BikeHistory.Mobile.Views.Maintenance"
    Shell.FlyoutBehavior="Disabled">

    <Shell.Resources>
        <ResourceDictionary>
            <Style x:Key="BaseStyle" TargetType="Element">
                <Setter Property="Shell.BackgroundColor" Value="{StaticResource BackgroundLight}" />
                <Setter Property="Shell.ForegroundColor" Value="{StaticResource TextPrimary}" />
                <Setter Property="Shell.TitleColor" Value="{StaticResource TextPrimary}" />
                <Setter Property="Shell.DisabledColor" Value="{StaticResource Gray400}" />
                <Setter Property="Shell.UnselectedColor" Value="{StaticResource Gray500}" />
            </Style>
            <Style TargetType="ShellContent" BasedOn="{StaticResource BaseStyle}" />
        </ResourceDictionary>
    </Shell.Resources>

    <Shell.TitleView>
        <Grid ColumnDefinitions="Auto,*,Auto" 
              VerticalOptions="Center" 
              Padding="16,8" 
              BackgroundColor="{StaticResource BackgroundLight}">
            
            <!-- Back Button (only visible when not on main page) -->
            <Label Grid.Column="0"
                   FontFamily="FontAwesome"
                   Text="&#xf060;"
                   FontSize="18"
                   TextColor="{StaticResource TextPrimary}"
                   VerticalOptions="Center"
                   HorizontalOptions="Start"
                   IsVisible="False"
                   x:Name="BackButton"
                   Margin="0,0,16,0">
                <Label.GestureRecognizers>
                    <TapGestureRecognizer Tapped="OnBackButtonTapped" />
                </Label.GestureRecognizers>
            </Label>
            
            <!-- Page Title -->
            <Label Grid.Column="1" 
                   Text="내 자전거"
                   FontFamily="IBM Plex Sans KR"
                   FontSize="24" 
                   FontAttributes="Bold"
                   TextColor="{StaticResource TextPrimary}"
                   VerticalOptions="Center"
                   HorizontalOptions="Start" />
            
            <!-- Profile Image Button -->
            <Frame Grid.Column="2"
                   BackgroundColor="Transparent"
                   BorderColor="Transparent"
                   HeightRequest="36"
                   WidthRequest="36"
                   CornerRadius="18"
                   Padding="0"
                   HasShadow="False"
                   VerticalOptions="Center"
                   HorizontalOptions="End">
                <Frame.GestureRecognizers>
                    <TapGestureRecognizer Tapped="OnProfileImageTapped" />
                </Frame.GestureRecognizers>
                <Image Source="default_profile.jpg" 
                       Aspect="AspectFill"
                       VerticalOptions="FillAndExpand"
                       HorizontalOptions="FillAndExpand">
                    <Image.Clip>
                        <EllipseGeometry Center="18,18" RadiusX="18" RadiusY="18" />
                    </Image.Clip>
                </Image>
            </Frame>
        </Grid>
    </Shell.TitleView>
    
    <ShellContent
        Title="로그인"
        ContentTemplate="{DataTemplate auth:LoginPage}"
        Route="login" />
    
    <!-- Main Content without TabBar -->
    <ShellContent
        Title="자전거"
        ContentTemplate="{DataTemplate bikes:BikeListPage}"
        Route="bikes">
        <ShellContent.Icon>
            <FontImageSource FontFamily="FontAwesome" 
                Glyph="&#xf206;" 
                Size="16" 
                Color="{StaticResource Primary}" />
        </ShellContent.Icon>
    </ShellContent>

</Shell>
