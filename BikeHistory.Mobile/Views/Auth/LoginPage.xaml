<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="BikeHistory.Mobile.Views.Auth.LoginPage"
             xmlns:viewmodel="clr-namespace:BikeHistory.Mobile.ViewModels"
             x:DataType="viewmodel:LoginViewModel"
             Title="로그인"
             Shell.NavBarIsVisible="False"
             BackgroundColor="#F5F5F5">

    <ContentPage.Resources>
        <ResourceDictionary>
            <!-- 카드 컨테이너 스타일 -->
            <Style x:Key="CardContainerStyle" TargetType="Border">
                <Setter Property="BackgroundColor" Value="White"/>
                <Setter Property="StrokeShape" Value="RoundRectangle 16"/>
                <Setter Property="StrokeThickness" Value="0"/>
                <Setter Property="Padding" Value="32,40"/>
                <Setter Property="Margin" Value="24,0"/>
                <Setter Property="Shadow">
                    <Shadow Brush="#20000000" Offset="0,8" Radius="24" Opacity="0.15"/>
                </Setter>
            </Style>

            <!-- 타이틀 스타일 -->
            <Style x:Key="WelcomeTitleStyle" TargetType="Label">
                <Setter Property="FontSize" Value="32"/>
                <Setter Property="FontAttributes" Value="Bold"/>
                <Setter Property="TextColor" Value="#2C2C2C"/>
                <Setter Property="HorizontalOptions" Value="Center"/>
                <Setter Property="Margin" Value="0,0,0,8"/>
            </Style>

            <!-- 서브타이틀 스타일 -->
            <Style x:Key="SubtitleStyle" TargetType="Label">
                <Setter Property="FontSize" Value="16"/>
                <Setter Property="TextColor" Value="#8E8E93"/>
                <Setter Property="HorizontalOptions" Value="Center"/>
                <Setter Property="Margin" Value="0,0,0,40"/>
            </Style>

            <!-- 입력 레이블 스타일 -->
            <Style x:Key="InputLabelStyle" TargetType="Label">
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="FontAttributes" Value="Bold"/>
                <Setter Property="TextColor" Value="#2C2C2C"/>
                <Setter Property="Margin" Value="0,0,0,8"/>
            </Style>

            <!-- 모던 엔트리 스타일 -->
            <Style x:Key="ModernEntryStyle" TargetType="Entry">
                <Setter Property="BackgroundColor" Value="#F8F9FA"/>
                <Setter Property="TextColor" Value="#2C2C2C"/>
                <Setter Property="PlaceholderColor" Value="#8E8E93"/>
                <Setter Property="FontSize" Value="16"/>
                <Setter Property="HeightRequest" Value="52"/>
                <Setter Property="Margin" Value="0,0,0,24"/>
            </Style>

            <!-- 엔트리 컨테이너 스타일 -->
            <Style x:Key="EntryContainerStyle" TargetType="Border">
                <Setter Property="BackgroundColor" Value="#F8F9FA"/>
                <Setter Property="StrokeShape" Value="RoundRectangle 12"/>
                <Setter Property="StrokeThickness" Value="1"/>
                <Setter Property="Stroke" Value="#E5E5EA"/>
            </Style>

            <!-- 그라데이션 버튼 스타일 -->
            <Style x:Key="GradientButtonStyle" TargetType="Button">
                <Setter Property="TextColor" Value="White"/>
                <Setter Property="FontSize" Value="16"/>
                <Setter Property="FontAttributes" Value="Bold"/>
                <Setter Property="HeightRequest" Value="52"/>
                <Setter Property="CornerRadius" Value="26"/>
                <Setter Property="Margin" Value="0,8,0,24"/>
            </Style>

            <!-- 링크 버튼 스타일 -->
            <Style x:Key="LinkButtonStyle" TargetType="Button">
                <Setter Property="BackgroundColor" Value="Transparent"/>
                <Setter Property="TextColor" Value="#007AFF"/>
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="BorderWidth" Value="0"/>
                <Setter Property="Padding" Value="0"/>
            </Style>

            <!-- 에러 레이블 스타일 -->
            <Style x:Key="ErrorLabelStyle" TargetType="Label">
                <Setter Property="TextColor" Value="#FF3B30"/>
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="HorizontalOptions" Value="Center"/>
                <Setter Property="Margin" Value="0,0,0,16"/>
            </Style>
        </ResourceDictionary>
    </ContentPage.Resources>

    <!-- 메인 컨테이너 -->
    <ScrollView>
        <StackLayout Spacing="0" Padding="0,60,0,40">
            
            <!-- 로그인 카드 -->
            <Border Style="{StaticResource CardContainerStyle}">
                <StackLayout Spacing="0">
                    
                    <!-- 헤더 섹션 -->
                    <StackLayout Spacing="0" Margin="0,0,0,32">
                        <Label Text="Welcome" 
                               Style="{StaticResource WelcomeTitleStyle}"/>
                        <Label Text="로그인하여 계속하세요" 
                               Style="{StaticResource SubtitleStyle}"/>
                    </StackLayout>

                    <!-- 이메일 입력 -->
                    <StackLayout Spacing="0" Margin="0,0,0,32">
                        <Label Text="이메일" 
                               Style="{StaticResource InputLabelStyle}"/>
                        <Entry Placeholder="example@email.com"
                                Text="{Binding Email}"
                                Keyboard="Email"
                                Style="{StaticResource ModernEntryStyle}"
                                Margin="0,0"/>                                                    
                    </StackLayout>

                    <!-- 비밀번호 입력 -->
                    <StackLayout Spacing="0">
                        <Label Text="비밀번호" 
                               Style="{StaticResource InputLabelStyle}"/>
                        <!--<Border Style="{StaticResource EntryContainerStyle}">
                            <Entry Placeholder="비밀번호를 입력하세요"
                                   Text="{Binding Password}"
                                   IsPassword="True"
                                   Style="{StaticResource ModernEntryStyle}"
                                   Margin="16,0"/>
                        </Border>-->
                            <Entry Placeholder="비밀번호를 입력하세요"
                                   Text="{Binding Password}"
                                   IsPassword="True"
                                   Style="{StaticResource ModernEntryStyle}"
                                   Margin="0,0"/>          
                    </StackLayout>

                    <!-- 에러 메시지 -->
                    <Label Text="{Binding ErrorMessage}"
                           Style="{StaticResource ErrorLabelStyle}"
                           IsVisible="{Binding ErrorMessage, Converter={StaticResource StringToBoolConverter}}"/>

                    <!-- 로그인 버튼 -->
                    <Border BackgroundColor="Transparent" 
                            StrokeThickness="0" 
                            StrokeShape="RoundRectangle 26"
                            Margin="0,8,0,24">
                        <Border.Background>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                <GradientStop Color="#667eea" Offset="0.0"/>
                                <GradientStop Color="#764ba2" Offset="1.0"/>
                            </LinearGradientBrush>
                        </Border.Background>
                        <Button Text="로그인"
                                Command="{Binding LoginCommand}"
                                IsEnabled="{Binding IsBusy, Converter={StaticResource InverseBoolConverter}}"
                                BackgroundColor="Transparent"
                                TextColor="White"
                                FontSize="16"
                                FontAttributes="Bold"
                                HeightRequest="52"
                                BorderWidth="0"/>
                    </Border>

                    <!-- 로딩 인디케이터 -->
                    <ActivityIndicator IsRunning="{Binding IsBusy}"
                                      IsVisible="{Binding IsBusy}"
                                      Color="#667eea"
                                      Scale="1.2"
                                      HorizontalOptions="Center"
                                      Margin="0,0,0,24"/>

                    <!-- 비밀번호 찾기 링크 -->
                    <Button Text="비밀번호를 잊으셨나요?"
                            Style="{StaticResource LinkButtonStyle}"
                            HorizontalOptions="Center"
                            Margin="0,0,0,32"/>

                    <!-- 구분선 -->
                    <!--<BoxView BackgroundColor="#E5E5EA" 
                             HeightRequest="1" 
                             Margin="0,0,0,24"/>-->

                    <!-- 회원가입 섹션 -->
                    <StackLayout Orientation="Horizontal" 
                                HorizontalOptions="Center" 
                                Spacing="4">
                        <Label Text="아직 계정이 없으신가요?" 
                               TextColor="#8E8E93" 
                               FontSize="14"
                               VerticalOptions="Center"/>
                        <Button Text="가입하기"
                                Command="{Binding GoToRegisterCommand}"
                                Style="{StaticResource LinkButtonStyle}"
                                FontAttributes="Bold"/>
                    </StackLayout>

                </StackLayout>
            </Border>

            <!-- 하단 여백 -->
            <BoxView HeightRequest="40" BackgroundColor="Transparent"/>
            
        </StackLayout>
    </ScrollView>
</ContentPage>