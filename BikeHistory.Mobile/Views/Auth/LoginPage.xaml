<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="BikeHistory.Mobile.Views.Auth.LoginPage"
             xmlns:viewmodel="clr-namespace:BikeHistory.Mobile.ViewModels"
             x:DataType="viewmodel:LoginViewModel"
             Title="로그인"
             Shell.NavBarIsVisible="False"
             BackgroundColor="Transparent">

    <ContentPage.Resources>
        <ResourceDictionary>
            <!-- 엔트리 스타일 -->
            <Style x:Key="ModernEntryStyle" TargetType="Entry">
                <Setter Property="BackgroundColor" Value="Transparent"/>
                <Setter Property="TextColor" Value="White"/>
                <Setter Property="PlaceholderColor" Value="#B0FFFFFF"/>
                <Setter Property="FontSize" Value="16"/>
                <Setter Property="HeightRequest" Value="50"/>
                <Setter Property="Margin" Value="0,10"/>
            </Style>

            <!-- 메인 버튼 스타일 -->
            <Style x:Key="PrimaryButtonStyle" TargetType="Button">
                <Setter Property="BackgroundColor" Value="#4CAF50"/>
                <Setter Property="TextColor" Value="White"/>
                <Setter Property="FontSize" Value="18"/>
                <Setter Property="FontAttributes" Value="Bold"/>
                <Setter Property="HeightRequest" Value="55"/>
                <Setter Property="CornerRadius" Value="25"/>
                <Setter Property="Margin" Value="0,20,0,10"/>
            </Style>

            <!-- 텍스트 버튼 스타일 -->
            <Style x:Key="TextButtonStyle" TargetType="Button">
                <Setter Property="BackgroundColor" Value="Transparent"/>
                <Setter Property="TextColor" Value="#81C784"/>
                <Setter Property="FontSize" Value="16"/>
                <Setter Property="BorderWidth" Value="0"/>
            </Style>

            <!-- 에러 레이블 스타일 -->
            <Style x:Key="ErrorLabelStyle" TargetType="Label">
                <Setter Property="TextColor" Value="#FF5252"/>
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="HorizontalOptions" Value="Center"/>
                <Setter Property="Margin" Value="0,10"/>
            </Style>
        </ResourceDictionary>
    </ContentPage.Resources>

    <!-- 메인 컨테이너 -->
    <Grid>
        <!-- 자전거 테마 그라데이션 배경 -->
        <Rectangle>
            <Rectangle.Fill>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                    <GradientStop Color="#2E7D32" Offset="0.0"/>
                    <GradientStop Color="#388E3C" Offset="0.5"/>
                    <GradientStop Color="#4CAF50" Offset="1.0"/>
                </LinearGradientBrush>
            </Rectangle.Fill>
        </Rectangle>

        <!-- 배경 장식 원들 -->
        <Ellipse WidthRequest="250" HeightRequest="250"
                 Fill="#20FFFFFF"
                 HorizontalOptions="Start" VerticalOptions="Start"
                 Margin="-125,-75,0,0"/>

        <Ellipse WidthRequest="180" HeightRequest="180"
                 Fill="#15FFFFFF"
                 HorizontalOptions="End" VerticalOptions="End"
                 Margin="0,0,-90,-90"/>

        <!-- 메인 콘텐츠 -->
        <ScrollView>
            <StackLayout Padding="40,60,40,40" Spacing="0">

                <!-- 로고 및 타이틀 섹션 -->
                <StackLayout Spacing="15" Margin="0,0,0,50">
                    <!-- 자전거 로고 -->
                    <Border BackgroundColor="#30FFFFFF"
                            WidthRequest="100" HeightRequest="100"
                            StrokeShape="RoundRectangle 50"
                            HorizontalOptions="Center">
                        <Grid>
                            <!-- 로고 이미지가 있다면 -->
                            <Image Source="logo.png" 
                                   WidthRequest="60" HeightRequest="60"
                                   HorizontalOptions="Center" VerticalOptions="Center"
                                   IsVisible="True"/>
                            <!-- 로고 이미지가 없다면 자전거 이모지 -->
                            <Label Text="🚴‍♂️" FontSize="50" 
                                   HorizontalOptions="Center" VerticalOptions="Center"
                                   IsVisible="False"/>
                        </Grid>
                    </Border>

                    <Label Text="자전거 이력 관리" 
                           FontSize="28" FontAttributes="Bold" 
                           TextColor="White" HorizontalOptions="Center"/>

                    <Label Text="나만의 자전거 관리 시스템" 
                           FontSize="16" TextColor="#B0FFFFFF" 
                           HorizontalOptions="Center"/>
                </StackLayout>

                <!-- 로그인 폼 -->
                <Border BackgroundColor="#25FFFFFF"
                        StrokeShape="RoundRectangle 20"
                        StrokeThickness="1"
                        Stroke="#40FFFFFF"
                        Padding="30,40">

                    <StackLayout Spacing="0">
                        <!-- 이메일 입력 -->
                        <Label Text="이메일" TextColor="#B0FFFFFF" FontSize="14" Margin="0,0,0,5"/>
                        <Border BackgroundColor="#20FFFFFF"
                                StrokeShape="RoundRectangle 12"
                                StrokeThickness="1"
                                Stroke="#40FFFFFF">
                            <Entry Placeholder="이메일을 입력하세요"
                                   Text="{Binding Email}"
                                   Keyboard="Email"
                                   Style="{StaticResource ModernEntryStyle}"
                                   Margin="15,0"/>
                        </Border>

                        <!-- 비밀번호 입력 -->
                        <Label Text="비밀번호" TextColor="#B0FFFFFF" FontSize="14" Margin="0,20,0,5"/>
                        <Border BackgroundColor="#20FFFFFF"
                                StrokeShape="RoundRectangle 12"
                                StrokeThickness="1"
                                Stroke="#40FFFFFF">
                            <Entry Placeholder="비밀번호를 입력하세요"
                                   Text="{Binding Password}"
                                   IsPassword="True"
                                   Style="{StaticResource ModernEntryStyle}"
                                   Margin="15,0"/>
                        </Border>

                        <!-- 에러 메시지 -->
                        <Label Text="{Binding ErrorMessage}"
                               Style="{StaticResource ErrorLabelStyle}"
                               IsVisible="{Binding ErrorMessage, Converter={StaticResource StringToBoolConverter}}"
                               Margin="0,15,0,0"/>

                        <!-- 로그인 버튼 -->
                        <Button Text="로그인"
                                Command="{Binding LoginCommand}"
                                IsEnabled="{Binding IsBusy, Converter={StaticResource InverseBoolConverter}}"
                                Style="{StaticResource PrimaryButtonStyle}">
                            <Button.Shadow>
                                <Shadow Brush="#40000000" Offset="0,4" Radius="8" Opacity="0.3"/>
                            </Button.Shadow>
                        </Button>

                        <!-- 로딩 인디케이터 -->
                        <ActivityIndicator IsRunning="{Binding IsBusy}"
                                          IsVisible="{Binding IsBusy}"
                                          Color="White"
                                          Scale="1.2"
                                          HorizontalOptions="Center"
                                          Margin="0,10"/>
                    </StackLayout>
                </Border>

                <!-- 추가 옵션들 -->
                <StackLayout Margin="0,30,0,0" Spacing="20">
                    <!-- 자동 로그인 옵션 (필요시) -->
                    <StackLayout Orientation="Horizontal" 
                                HorizontalOptions="Center" 
                                Spacing="10"
                                IsVisible="False">
                        <CheckBox Color="#4CAF50"/>
                        <Label Text="자동 로그인" 
                               TextColor="#B0FFFFFF" FontSize="14"
                               VerticalOptions="Center"/>
                    </StackLayout>

                    <!-- 비밀번호 찾기 (필요시) -->
                    <Label Text="비밀번호를 잊으셨나요?" 
                           TextColor="#81C784" FontSize="14"
                           HorizontalOptions="Center"
                           IsVisible="False">
                        <Label.GestureRecognizers>
                            <TapGestureRecognizer/>
                        </Label.GestureRecognizers>
                    </Label>
                </StackLayout>

                <!-- 회원가입 버튼 -->
                <StackLayout Orientation="Horizontal" 
                            HorizontalOptions="Center" 
                            Margin="0,40,0,0">
                    <Label Text="계정이 없으신가요? " 
                           TextColor="#B0FFFFFF" FontSize="16"
                           VerticalOptions="Center"/>
                    <Button Text="회원가입"
                            Command="{Binding GoToRegisterCommand}"
                            Style="{StaticResource TextButtonStyle}"
                            Padding="5,0"/>
                </StackLayout>

                <!-- 자전거 관련 포인트 -->
                <StackLayout Margin="0,40,0,0" Spacing="15">
                    <Label Text="BikeHistory와 함께" 
                           TextColor="#B0FFFFFF" FontSize="14" 
                           HorizontalOptions="Center"/>

                    <Grid ColumnDefinitions="*,*,*" ColumnSpacing="20">
                        <!-- 기능 1 -->
                        <StackLayout Grid.Column="0" Spacing="5">
                            <Label Text="🔧" FontSize="24" HorizontalOptions="Center"/>
                            <Label Text="정비 기록" 
                                   TextColor="#B0FFFFFF" FontSize="12" 
                                   HorizontalOptions="Center"/>
                        </StackLayout>

                        <!-- 기능 2 -->
                        <StackLayout Grid.Column="1" Spacing="5">
                            <Label Text="📊" FontSize="24" HorizontalOptions="Center"/>
                            <Label Text="주행 통계" 
                                   TextColor="#B0FFFFFF" FontSize="12" 
                                   HorizontalOptions="Center"/>
                        </StackLayout>

                        <!-- 기능 3 -->
                        <StackLayout Grid.Column="2" Spacing="5">
                            <Label Text="📱" FontSize="24" HorizontalOptions="Center"/>
                            <Label Text="간편 관리" 
                                   TextColor="#B0FFFFFF" FontSize="12" 
                                   HorizontalOptions="Center"/>
                        </StackLayout>
                    </Grid>
                </StackLayout>

                <!-- 하단 여백 -->
                <BoxView HeightRequest="40" BackgroundColor="Transparent"/>
            </StackLayout>
        </ScrollView>
    </Grid>
</ContentPage>